#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–µ–ø–ª–æ—è Weather Bot –Ω–∞ GitHub
"""

import os
import subprocess
import sys
from pathlib import Path

def run_command(command, description=""):
    """–í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –∏ –ø–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç"""
    print(f"üîÑ {description}")
    print(f"   –ö–æ–º–∞–Ω–¥–∞: {command}")
    
    try:
        result = subprocess.run(command, shell=True, capture_output=True, text=True)
        if result.returncode == 0:
            print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ!")
            if result.stdout.strip():
                print(f"   –í—ã–≤–æ–¥: {result.stdout.strip()}")
        else:
            print(f"‚ùå –û—à–∏–±–∫–∞: {result.stderr.strip()}")
            return False
    except Exception as e:
        print(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {e}")
        return False
    
    print()
    return True

def check_git_installed():
    """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ git"""
    try:
        subprocess.run(["git", "--version"], capture_output=True, check=True)
        return True
    except:
        return False

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("üöÄ –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π Weather Bot –Ω–∞ GitHub")
    print("=" * 50)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ git
    if not check_git_installed():
        print("‚ùå Git –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω! –£—Å—Ç–∞–Ω–æ–≤–∏ git –∏ –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞.")
        return 1
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    print("\nüìù –í–≤–µ–¥–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è GitHub:")
    
    username = input("GitHub username: ").strip()
    if not username:
        print("‚ùå Username –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω!")
        return 1
    
    repo_name = input("–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: weather-bot): ").strip()
    if not repo_name:
        repo_name = "weather-bot"
    
    description = input("–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): ").strip()
    if not description:
        description = "Telegram Weather Bot with daily notifications and multi-language support"
    
    print(f"\nüìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:")
    print(f"   Username: {username}")
    print(f"   –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: {repo_name}")
    print(f"   –û–ø–∏—Å–∞–Ω–∏–µ: {description}")
    print(f"   URL: https://github.com/{username}/{repo_name}")
    
    confirm = input("\n‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (y/n): ").strip().lower()
    if confirm not in ['y', 'yes', '–¥–∞', '–¥']:
        print("‚ùå –û—Ç–º–µ–Ω–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
        return 1
    
    print("\nüîß –ù–∞—á–∏–Ω–∞—é –¥–µ–ø–ª–æ–π...")
    
    # –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
    if not run_command("git init", "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"):
        return 1
    
    # –®–∞–≥ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
    if not run_command("git add .", "–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤"):
        return 1
    
    # –®–∞–≥ 3: –ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç
    commit_message = "Initial commit: Weather Bot with emojis and multi-language support"
    if not run_command(f'git commit -m "{commit_message}"', "–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∫–æ–º–º–∏—Ç–∞"):
        return 1
    
    # –®–∞–≥ 4: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–µ—Ç–∫–∏ –≤ main
    if not run_command("git branch -M main", "–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–µ—Ç–∫–∏ –≤ main"):
        return 1
    
    # –®–∞–≥ 5: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ remote origin
    remote_url = f"https://github.com/{username}/{repo_name}.git"
    if not run_command(f"git remote add origin {remote_url}", "–î–æ–±–∞–≤–ª–µ–Ω–∏–µ remote origin"):
        return 1
    
    print("üéØ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≥–æ—Ç–æ–≤!")
    print("\nüìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:")
    print("1. –°–æ–∑–¥–∞–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub:")
    print(f"   - –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ https://github.com/new")
    print(f"   - Repository name: {repo_name}")
    print(f"   - Description: {description}")
    print(f"   - –í—ã–±–µ—Ä–∏ Public")
    print(f"   - –ù–ï –¥–æ–±–∞–≤–ª—è–π README, .gitignore –∏–ª–∏ license (—É –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å)")
    print(f"   - –ù–∞–∂–º–∏ 'Create repository'")
    print()
    print("2. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–∏:")
    print(f"   git push -u origin main")
    print()
    print("3. –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –µ—â–µ —Ä–∞–∑ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º --push")
    
    # –û–ø—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ push
    if len(sys.argv) > 1 and sys.argv[1] == "--push":
        print("\nüöÄ –í—ã–ø–æ–ª–Ω—è—é push –Ω–∞ GitHub...")
        if run_command("git push -u origin main", "Push –Ω–∞ GitHub"):
            print("üéâ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –Ω–∞ GitHub!")
            print(f"üîó –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://github.com/{username}/{repo_name}")
        else:
            print("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ push. –£–±–µ–¥–∏—Å—å —á—Ç–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω –Ω–∞ GitHub.")
            return 1
    
    return 0

if __name__ == "__main__":
    sys.exit(main())
